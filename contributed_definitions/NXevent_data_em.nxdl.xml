<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2014-2022 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXevent_data_em" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <doc>
         Base class to store state and (meta)data of an electron microscopy research event.
         
         The need for such a structuring instance inside NXevent_data_em_set is evident
         from the fact that electron microscopes are dynamic. Oftentimes it suffices
         to calibrate the instrument at the start of the session and use it throughout.
         How a microscope is used during this session and which pieces of information
         are collected is case dependent.
         
         NXevent_data_em represents an instance to describe and serialize flexibly
         whatever a researcher considers as the smallest discretization in time
         for which the instrument is considered stable and data may or not be collected
         during that time interval.
         
         The key idea behind offering such a modularized and generalized documentation
         system via NXevent_data_em and related base classes is not to demand that every
         user has to keep and document these data but if this is desired and useful
         for a research study users should use this base class, i.e. its concepts,
         its concept names, and taxonomy to document these pieces of information
         with the here standardized schema.
         
         For this reason the base class defines all fields and groups as optional.
         It is then the actual application definition which may demand - with the aim
         to enable verification of the record generated for the microscope session -
         that some of the here well-defined, concepts, names, and branches
         of the taxonomy are set as required or not.
         
         We are aware that given the variety how a microscope can be configured and used
         these application definitions may be group-specific, method-specific, maybe
         even project-specific. Therefore, the NXem application definition is de facto
         only one suggestion how such an application definition can look like.
         The key point is thought that just because one has different requirements
         this does not warrant to also cook up always an own schema in which the same
         concepts have such different names and even worse are placed in different
         locations of the taxonomy that is used for the serialization of the schema.
    </doc>
    <field name="start_time" type="NX_DATE_TIME">
        <doc>
             ISO 8601 time code with local time zone offset to UTC information included
             when the snapshot time interval started. If the user wishes to specify an
             interval of time that the snapshot should represent during which the instrument
             was stable and configured using specific settings and calibrations,
             the start_time is the start (left bound of the time interval) while
             the end_time specifies the end (right bound) of the time interval.
        </doc>
    </field>
    <field name="end_time" type="NX_DATE_TIME">
        <doc>
             ISO 8601 time code with local time zone offset to UTC information included
             when the snapshot time interval ended.
        </doc>
    </field>
    <field name="event_identifier" type="NX_UINT" units="NX_UNITLESS">
        <doc>
             Identifier of a specific state and setting of the microscope.
        </doc>
    </field>
    <field name="event_type">
        <doc>
             Which specific event/measurement type. Examples are:
             
             * In-lens/backscattered electron, usually has quadrants
             * Secondary_electron, image, topography, fractography, overview images
             * Backscattered_electron, image, Z or channeling contrast (ECCI)
             * Bright_field, image, TEM
             * Dark_field, image, crystal defects
             * Annular dark field, image (medium- or high-angle), TEM
             * Diffraction, image, TEM, or a comparable technique in the SEM
             * Kikuchi, image, SEM EBSD and TEM diffraction
             * X-ray spectra (point, line, surface, volume), composition EDS/EDX(S)
             * Electron energy loss spectra for points, lines, surfaces, TEM
             * Auger, spectrum, (low Z contrast element composition)
             * Cathodoluminescence (optical spectra)
             * Ronchigram, image, alignment utility specifically in TEM
             * Chamber, e.g. TV camera inside the chamber, education purposes.
             
             This field may also be used for storing additional information
             about the event. For which there is at the moment no other place.
             
             In the long run such free-text field description should be avoid however
             as they are difficult to machine-interpret. The reason why in this base
             class the field event_type is nonetheless kept is to offer a place
             whereby practically users may enter data for follow-up modifications
             to arrive at an improve NXevent_data_em base class.
        </doc>
    </field>
    <group type="NXimage_r_set_diff"/>
    <group type="NXimage_r_set"/>
    <group type="NXimage_c_set"/>
    <group type="NXspectrum_set"/>
    <group name="em_lab" type="NXinstrument">
        <doc>
             (Meta)data of the dynamics and changes of the microscope during the event.
        </doc>
        <!--no need to duplicate the fabrication because that should remain the-->
        <group type="NXchamber"/>
        <group type="NXebeam_column"/>
        <group type="NXibeam_column"/>
        <group type="NXoptical_system_em"/>
        <group type="NXdetector"/>
        <group type="NXpump"/>
        <group type="NXstage_lab"/>
    </group>
    <group type="NXuser"/>
    <group type="NXinteraction_vol_em"/>
</definition>

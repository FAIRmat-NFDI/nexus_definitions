<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
#
# Copyright (C) 2023-2025 NeXus International Advisory Committee (NIAC)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="application" type="group" name="NXmpes_liquid" extends="NXmpes" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <doc>
        This is the application definition for multidimensional photoelectron spectroscopy on liquids.
        It extends the NXmpes application definition by metadata for characterizing liquidjet composition
        and geometry.
    </doc>
    <group type="NXentry">
        <field name="definition">
            <attribute name="version"/>
            <enumeration>
                <item value="NXmpes_liquid"/>
            </enumeration>
        </field>
        <group name="jet_coordinate_system" type="NXcoordinate_system" recommended="true">
            <doc>
                Orientation of the liquid jet with respect to the beam. The major flow direction of the jet is defined as
                pointing in the -y direction. In case of flatjets this is the propagation direction of the jet after the
                leafs are merged completely. The surface normal is defined as pointing in the +z direction. For flat jets,
                normal vector of the first leaf in the half-plane oriented towards the electron detector. A 180 degree
                rotation around the y axis exposes the back surface of the first leaf. The z axis should be pre-rotated to
                coincide with the z-direction of analyzer coordinate system. For cylindrical jets the surface normal is
                defined to always align with the analyzer coordinate system independent of any applied rotations.
            </doc>
            <field name="origin">
                <enumeration>
                    <item value="center of interaction"/>
                </enumeration>
            </field>
            <field name="y_direction">
                <enumeration>
                    <item value="major propagation direction of the liquid jet"/>
                </enumeration>
            </field>
            <field name="z_direction">
                <enumeration>
                    <item value="liquid surface normal (of first leaf for flatjets)"/>
                </enumeration>
            </field>
            <field name="x" type="NX_NUMBER">
                <enumeration>
                    <item value="[-1, 0, 0]"/>
                </enumeration>
            </field>
            <field name="y" type="NX_NUMBER">
                <enumeration>
                    <item value="[0, 1, 0]"/>
                </enumeration>
            </field>
            <field name="z" type="NX_NUMBER">
                <enumeration>
                    <item value="[0, 0, 1]"/>
                </enumeration>
            </field>
            <field name="depends_on" type="NX_CHAR">
                <doc>
                    Link to transformations defining the base jet coordinate system, which is defined such that the positive
                    z-axis points along the liquid surface normal, and the y-axis points along the major jet propagation direction.
                </doc>
            </field>
            <group type="NXtransformations" optional="true">
                <doc>
                    Set of transformations, describing the orientation of the jet coordinate system
                    with respect to the beam coordinate system (.).
                </doc>
            </group>
        </group>
        <group type="NXsample">
            <field name="thickness" type="NX_FLOAT" recommended="true" units="NX_LENGTH">
                <doc>
                    Thickness of the sample in normal direction to the surface that is probed,
                    e.g., diameter of capillary (round jets) or thickness of the leaf (flat jets).
                </doc>
            </field>
            <field name="flow_rate" type="NX_FLOAT" recommended="true" units="NX_ANY">
                <doc>
                    Flow rate of the liquid into the chamber, i.e.,
                    through the microjet capillary (or in case of a flat jet: both capillaries).
                    Unit should be NX_VOLUME / NX_TIME.
                </doc>
            </field>
            <field name="shape" type="NX_CHAR">
                <enumeration>
                    <item value="round"/>
                    <item value="flat"/>
                </enumeration>
            </field>
            <field name="nozzle_material" type="NX_CHAR" recommended="true">
                <doc>
                    Material the microjet nozzle is made of
                    (users are encouraged to expand on that in group history/sample_preparation).
                </doc>
            </field>
            <group name="temperature_env" type="NXenvironment" optional="true">
                <doc>
                    The temperature set for the liquid jet or the injection assembly.
                    Details may be added through instances of NXsensor/NXactuator on how this temperature
                    value is obtained (whether a chiller unit was used, point of cooling, temperature reading
                    etc.) and where this value would be expected (estimate for the jet assembly, the liquid
                    prior to injection,  or at the interaction point taking into account evaporative cooling etc.).
                </doc>
            </group>
            <group name="gas_pressure_env" type="NXenvironment" optional="true">
                <doc>
                    Pressure in the interaction chamber under operation conditions and actuators/sensors
                    controlling/measuring it.
                </doc>
            </group>
            <field name="depends_on" recommended="true">
                <doc>
                    Reference to the transformation describing the orientation of the jet
                    relative to a defined coordinate system.
                </doc>
            </field>
            <group name="transformations" type="NXtransformations" recommended="true">
                <field name="jet_surface_rotation" type="NX_NUMBER" units="NX_ANGLE">
                    <doc>
                        Rotation of the liquid surface normal around the major propagation direction.
                    </doc>
                    <attribute name="transformation_type">
                        <enumeration>
                            <item value="rotation"/>
                        </enumeration>
                    </attribute>
                    <attribute name="vector" type="NX_NUMBER">
                        <enumeration>
                            <item value="[0, 1, 0]"/>
                        </enumeration>
                    </attribute>
                    <attribute name="depends_on">
                        <enumeration>
                            <item value="jet_surface_tilt"/>
                        </enumeration>
                    </attribute>
                </field>
                <field name="jet_surface_tilt" type="NX_NUMBER" units="NX_ANGLE">
                    <doc>
                        Tilt of the liquid surface normal around the axis perpendicular to the major
                        propagation direction.
                    </doc>
                    <attribute name="transformation_type">
                        <enumeration>
                            <item value="rotation"/>
                        </enumeration>
                    </attribute>
                    <attribute name="vector" type="NX_NUMBER">
                        <enumeration>
                            <item value="[1, 0, 0]"/>
                        </enumeration>
                    </attribute>
                    <attribute name="depends_on">
                        <doc>
                            This should point to the coordinate system defined in
                            /entry/jet_coordinate_system.
                        </doc>
                    </attribute>
                </field>
            </group>
            <group name="solventSOLVENT" type="NXsample_component" nameType="partial">
                <doc>
                    Solvent substance of the liquid jet.
                    For flat jets, this group may appear more than once.
                    If a mixture of solvents is used,
                    the one with the highest mol fraction should be designated solvent,
                    and the other(s) solute(s) (see solute group).
                </doc>
                <field name="description" type="NX_CHAR" recommended="true"/>
                <field name="name" type="NX_CHAR"/>
                <field name="chemical_formula" type="NX_CHAR">
                    <doc>
                        Molecular or structural formula of the solvent.
                    </doc>
                </field>
                <field name="chem_id_cas" type="NX_CHAR" recommended="true"/>
                <field name="ph_value" type="NX_FLOAT" optional="true" units="NX_UNITLESS">
                    <doc>
                        Measured pH value of the solution.
                    </doc>
                </field>
                <field name="ph_adjustment" type="NX_BOOLEAN" optional="true">
                    <doc>
                        Whether or not agents for pH adjustment were added to the solution.
                        In this case, users are encouraged to expand on that in the ``history`` group
                        or add a corresponding solute group.
                    </doc>
                </field>
                <field name="mol_fraction" type="NX_FLOAT" optional="true" units="NX_ANY">
                    <doc>
                        Molarity of the solvent in the solution.
                        Unit should be 1 / NX_VOLUME.
                    </doc>
                </field>
            </group>
            <group name="soluteSOLUTE" type="NXsample_component" nameType="partial">
                <doc>
                    Solute substance solved in a given solvent.
                    This also accounts for multiple solutes if more than one is given.
                </doc>
                <field name="description" type="NX_CHAR" recommended="true"/>
                <field name="name" type="NX_CHAR"/>
                <field name="chemical_formula" type="NX_CHAR">
                    <doc>
                        Molecular or structural formula of the solute.
                    </doc>
                </field>
                <field name="chem_id_cas" type="NX_CHAR" recommended="true"/>
                <field name="mol_fraction" type="NX_FLOAT" recommended="true" units="NX_ANY">
                    <doc>
                        Molarity of the solute in the solution.
                        Unit should be 1 / NX_VOLUME
                    </doc>
                </field>
                <field name="solvent" type="NX_CHAR">
                    <doc>
                        Specifies the parent solvent entry of the solution.
                    </doc>
                </field>
            </group>
        </group>
    </group>
</definition>

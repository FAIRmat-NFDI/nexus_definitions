category: base
doc: |
  A base class definition for a phase-locked loop (PLL) used in AFM experiments.
  
  The PLL has three main components:
    1. Phase-detector
    2. Loop-filter
    3. Voltage-controlled oscillator (VCO)
type: group
NXspm_phase_lock_loop(NXobject):
  hardware(NXfabrication):
    doc: |
      Manufacturer and model of the PLL hardware or controller.
  calibration(NXcalibration):
    doc: |
      Calibration information for the PLL, including any relevant parameters
      or procedures.
  type(NX_CHAR):
    doc: |
      Type of the PLL from type-1, type-2, and type-3 available in device specifications.
      Type is defined from the number of poles exist in the transfer function of the PLL.
    enumeration: [type-1, type-2, type-3]
  order(NX_NUMBER):
    doc: |
      Order of the PLL. This is characteristics of circuit design and defined as roots of
      characteristics polynomial.
  frequency_bandwidth(NX_NUMBER):
    unit: NX_FREQUENCY
    doc: |
      The frequency bandwidth of the PLL where it responds or is stable.
  frequency_step(NX_NUMBER):
    unit: NX_FREQUENCY
    doc: |
      The frequency step size of the PLL, which determines the resolution of frequency
      changes.
  phase_detector(NXcomponent):
    doc: |
      The phase detector component of the PLL, which compares the phase between the
      reference signal generated by cantilever and the signal coming from the VCO.
    reference_frequency(NX_NUMBER):
      unit: NX_FREQUENCY
      doc: |
        The input reference frequency to the PLL through the component Phase-detector.
    frequency_shift(NX_NUMBER):
      unit: NX_FREQUENCY
      doc: |
        Measured shift in oscillation from VCO. relative to the reference frequency.
    reference_phase(NX_NUMBER):
      unit: NX_ANGLE
      doc: |
        Reference phase of the input signal to phase detector.
    phase_difference(NX_NUMBER):
      unit: NX_ANGLE
      doc: |
        Measured phase difference (also called phase error) between the reference signal
        and the VCO output.
    Kp_coefficient(NX_NUMBER):
      nameType: specified
      unit: ANY
      doc: |
        The gain coefficient of the phase detector, which determines how much the output
        voltage changes in response to a phase difference (V/rad).
  loop_filter(NXcomponent):
    doc: |
      The loop filter component of the PLL, which filters voltage from the phase detector to the VCO.
      It extracts the average voltage of the phase error from the phase detector.
    Kf_coefficient(NX_NUMBER):
      nameType: specified
      unit: NX_DIMENSIONLESS
      doc: |
        The Kf coefficient, called loop filter gain, that determines the gain of the
        loop filter in the PLL.
  voltage_controlled_oscillator(NXcomponent):
    doc: |
      The voltage-controlled oscillator (VCO) component of the PLL, which generates the output signal
      based on the filtered voltage from the loop filter.
    output_frequency_range(NX_NUMBER):
      unit: NX_FREQUENCY
      doc: |
        The output frequency range (written in array of frequency) of the VCO, which is the range of frequencies it can generate.
        The range either same of the frequency bandwidth of the PLL or shorter and inside the bandwidth.
    Kn_coefficient(NX_NUMBER):
      nameType: specified
      doc: |
        The Kn coefficient, called input-output frequency ratio, that relates the input frequency to the output frequency of the VCO.
        This coefficient is used to adjust the output frequency based on the input frequency.
    Ko_coefficient(NX_NUMBER):
      nameType: specified
      unit: ANY
      doc: |
        The output voltage coefficient of the VCO, which determines how much the output
        frequency changes in response to a change in input voltage (Hz/V).

# ++++++++++++++++++++++++++++++++++ SHA HASH ++++++++++++++++++++++++++++++++++
# 86bd7f146e39fa0da8e7aff0ba2cb9056c2bd0cc7c7c9313780a21cfc6e01176
# <?xml version='1.0' encoding='UTF-8'?>
# <?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
# <!--
# # NeXus - Neutron and X-ray Common Data Format
# #
# # Copyright (C) 2025-2025 NeXus International Advisory Committee (NIAC)
# #
# # This library is free software; you can redistribute it and/or
# # modify it under the terms of the GNU Lesser General Public
# # License as published by the Free Software Foundation; either
# # version 3 of the License, or (at your option) any later version.
# #
# # This library is distributed in the hope that it will be useful,
# # but WITHOUT ANY WARRANTY; without even the implied warranty of
# # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# # Lesser General Public License for more details.
# #
# # You should have received a copy of the GNU Lesser General Public
# # License along with this library; if not, write to the Free Software
# # Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
# #
# # For further information, see http://www.nexusformat.org
# -->
# <definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXspm_phase_lock_loop" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
#     <doc>
#         A base class definition for a phase-locked loop (PLL) used in AFM experiments.
#         
#         The PLL has three main components:
#           1. Phase-detector
#           2. Loop-filter
#           3. Voltage-controlled oscillator (VCO)
#     </doc>
#     <group name="hardware" type="NXfabrication">
#         <doc>
#             Manufacturer and model of the PLL hardware or controller.
#         </doc>
#     </group>
#     <group name="calibration" type="NXcalibration">
#         <doc>
#             Calibration information for the PLL, including any relevant parameters
#             or procedures.
#         </doc>
#     </group>
#     <field name="type" type="NX_CHAR">
#         <doc>
#             Type of the PLL from type-1, type-2, and type-3 available in device specifications.
#             Type is defined from the number of poles exist in the transfer function of the PLL.
#             # TODO: What is trasfer function.
#         </doc>
#         <!--TODO: What is trasfer function.-->
#         <enumeration>
#             <item value="type-1"/>
#             <item value="type-2"/>
#             <item value="type-3"/>
#         </enumeration>
#     </field>
#     <field name="order" type="NX_NUMBER">
#         <doc>
#             Order of the PLL. This is characteristics of circuit design and defined as roots of
#             characteristics polynomial.
#         </doc>
#     </field>
#     <field name="frequency_bandwidth" type="NX_NUMBER" units="NX_FREQUENCY">
#         <doc>
#             The frequency bandwidth of the PLL where it responds or is stable.
#         </doc>
#     </field>
#     <field name="frequency_step" type="NX_NUMBER" units="NX_FREQUENCY">
#         <doc>
#             The frequency step size of the PLL, which determines the resolution of frequency
#             changes.
#         </doc>
#     </field>
#     <group name="phase_detector" type="NXcomponent">
#         <doc>
#             The phase detector component of the PLL, which compares the phase between the
#             reference signal generated by cantilever and the signal coming from the VCO.
#         </doc>
#         <field name="reference_frequency" type="NX_NUMBER" units="NX_FREQUENCY">
#             <doc>
#                 The input reference frequency to the PLL through the component Phase-detector.
#             </doc>
#         </field>
#         <field name="frequency_shift" type="NX_NUMBER" units="NX_FREQUENCY">
#             <doc>
#                 Measured shift in oscillation from VCO. relative to the reference frequency.
#             </doc>
#         </field>
#         <field name="reference_phase" type="NX_NUMBER" units="NX_ANGLE">
#             <doc>
#                 Reference phase of the input signal to phase detector.
#             </doc>
#         </field>
#         <field name="phase_difference" type="NX_NUMBER" units="NX_ANGLE">
#             <doc>
#                 Measured phase difference (also called phase error) between the reference signal
#                 and the VCO output.
#             </doc>
#         </field>
#         <field name="Kp_coefficient" type="NX_NUMBER" nameType="specified" units="ANY">
#             <doc>
#                 The gain coefficient of the phase detector, which determines how much the output
#                 voltage changes in response to a phase difference (V/rad).
#             </doc>
#         </field>
#     </group>
#     <!--TODO: add some coefficients-->
#     <group name="loop_filter" type="NXcomponent">
#         <doc>
#             The loop filter component of the PLL, which filters voltage from the phase detector to the VCO.
#             It extracts the average voltage of the phase error from the phase detector.
#         </doc>
#         <field name="Kf_coefficient" type="NX_NUMBER" nameType="specified" units="NX_DIMENSIONLESS">
#             <doc>
#                 The Kf coefficient, called loop filter gain, that determines the gain of the
#                 loop filter in the PLL.
#             </doc>
#         </field>
#     </group>
#     <group name="voltage_controlled_oscillator" type="NXcomponent">
#         <doc>
#             The voltage-controlled oscillator (VCO) component of the PLL, which generates the output signal
#             based on the filtered voltage from the loop filter.
#         </doc>
#         <field name="output_frequency_range" type="NX_NUMBER" units="NX_FREQUENCY">
#             <doc>
#                 The output frequency range (written in array of frequency) of the VCO, which is the range of frequencies it can generate.
#                 The range either same of the frequency bandwidth of the PLL or shorter and inside the bandwidth.
#             </doc>
#         </field>
#         <field name="Kn_coefficient" type="NX_NUMBER" nameType="specified">
#             <doc>
#                 The Kn coefficient, called input-output frequency ratio, that relates the input frequency to the output frequency of the VCO.
#                 This coefficient is used to adjust the output frequency based on the input frequency.
#             </doc>
#         </field>
#         <field name="Ko_coefficient" type="NX_NUMBER" nameType="specified" units="ANY">
#             <doc>
#                 The output voltage coefficient of the VCO, which determines how much the output
#                 frequency changes in response to a change in input voltage (Hz/V).
#             </doc>
#         </field>
#     </group>
# </definition>

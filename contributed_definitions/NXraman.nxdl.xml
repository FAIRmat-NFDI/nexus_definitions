<?xml version='1.0' encoding='UTF-8'?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
#
# Copyright (C) 2014-2024 NeXus International Advisory Committee (NIAC)
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<!--
03/2024
A draft version of a NeXus application definition for Raman spectroscopy.-->
<!--
The document has the following main elements:
- Instrument used and is characteristics
- Sample: Properties of the sample
- Data: measured data, data errors
- Derived parameters: e.g. extra parameters derived in the measurement software-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="application" type="group" name="NXraman" extends="NXopt" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <symbols>
        <doc>
             Variables used throughout the document, e.g. dimensions or parameters.
        </doc>
        <symbol name="N_spectrum">
            <doc>
                 Length of the spectrum array (e.g. wavelength or energy) of the measured
                 data.
            </doc>
        </symbol>
        <symbol name="N_sensors">
            <doc>
                 Number of sensors used to measure parameters that influence the sample,
                 such as temperature or pressure.
            </doc>
        </symbol>
        <symbol name="N_measurements">
            <doc>
                 Number of measurements (1st dimension of measured_data array). This is
                 equal to the number of parameters scanned. For example, if the experiment
                 was performed at three different temperatures and two different pressures
                 N_measurements = 2*3 = 6.
            </doc>
        </symbol>
        <symbol name="N_scattering_configurations">
            <doc>
                 Number of scattering configurations used in the measurement.
                 It is 1 for only parallel polarization meausement, 2 for parallel and cross 
                 polarization measurement or larger, if i.e. the incident and scattered photon
                 direction is varied.
            </doc>
        </symbol>
        <symbol name="N_observables">
            <doc>
                 Number of observables that are saved in a measurement. e.g. one for
                 intensity, reflectivity or transmittance, two for Psi and Delta etc. This
                 is equal to the second dimension of the data array 'measured_data' and the
                 number of column names.
            </doc>
        </symbol>
        <symbol name="N_time">
            <doc>
                 Number of time points measured, the length of NXsample/time_points
            </doc>
        </symbol>
        <symbol name="N_spectrum_filter">
            <doc>
                 Number of points for a spectral filter used in the setup
            </doc>
        </symbol>
    </symbols>
    <doc>
         An application definition for Raman spectrocopy experiments.
         
         Information on Raman spectroscopy are provided in:
         
         General
         
         * Lewis, Ian R.; Edwards, Howell G. M.
           Handbook of Raman Spectroscopy
           ISBN 0-8247-0557-2
         
         Raman scattering selection rules
         
         * Dresselhaus, M. S.; Dresselhaus, G.; Jorio, A.
           Group Theory - Application to the Physics ofCondensed Matter
           ISBN 3540328971
         
         Semiconductors
         
         * Manuel Cardona
           Light Scattering in Solids I
           eBook ISBN: 978-3-540-37568-5
           DOI: https://doi.org/10.1007/978-3-540-37568-5
         
         * Manuel Cardona, Gernot GÃ¼ntherodt
           Light Scattering in Solids II
           eBook ISBN:  978-3-540-39075-6
           DOI: https://doi.org/10.1007/3-540-11380-0
         
         * See as well other Books from the "Light Scattering in Solids" series:
           III: Recent Results
           IV: Electronic Scattering, Spin Effects, SERS, and Morphic Effects
           V: Superlattices and Other Microstructures
           VI: Recent Results, Including High-Tc Superconductivity
           VII: Crystal-Field and Magnetic Excitations
           VIII: Fullerenes, Semiconductor Surfaces, Coherent Phonons
           IX: Novel Materials and Techniques
         
         Glasses, Liquids, Gasses, ...
         
         Review articles:
         Stimulated Raman scattering, Coherent anti-Stokes Raman scattering,
         Surface-enhanced Raman scattering, Tip-enhanced Raman scattering
         * https://doi.org/10.1186/s11671-019-3039-2
    </doc>
    <group type="NXentry">
        <doc>
             This is the application definition describing Raman spectroscopy experiments.
             
             Such experiments may be as simple a single Raman spectrum from spontanous
             Raman scattering and range to Raman imaging Raman spectrometer,
             surface- and tip-enhanced Raman techniques, x-Ray Raman scattering, as well
             as resonant Raman scattering phenomena or multidimenional Raman spectra (i.e.
             varying temperature, pressure, electric field, ....)
             
             The application definition defines:
             
             * elements of the experimental instrument
             * calibration information if available
             * parameters used to tune the state of the sample
             * sample description
        </doc>
        <field name="definition">
            <doc>
                 An application definition for ellipsometry.
            </doc>
            <attribute name="version">
                <doc>
                     Version number to identify which definition of this application
                     definition was used for this entry/data.
                </doc>
            </attribute>
            <attribute name="url">
                <doc>
                     URL where to find further material (documentation, examples) relevant
                     to the application definition.
                </doc>
            </attribute>
            <enumeration>
                <item value="NXraman"/>
            </enumeration>
        </field>
        <field name="experiment_description">
            <doc>
                 An optional free-text description of the experiment.
                 
                 However, details of the experiment should be defined in the specific
                 fields of this application definition rather than in this experiment
                 description.
            </doc>
        </field>
        <field name="experiment_type">
            <doc>
                 Specify the type of Raman measurement.
            </doc>
            <enumeration>
                <item value="in situ Raman spectroscopy"/>
                <item value="resonant Raman spectroscopy"/>
                <item value="non-resonant Raman spectroscopy"/>
                <item value="Raman imaging"/>
                <item value="Tip-enhanced Raman spectroscopy (TERS)"/>
                <item value="Surface-enhanced Raman spectroscopy (SERS)"/>
                <item value="Surface plasmon polariton enhanced Raman scattering (SPPERS)"/>
                <item value="Hyper Raman spectroscopy (HRS)"/>
                <item value="Stimulated Raman spectroscopy (SRS)"/>
                <item value="Inverse Raman spectroscopy (IRS)"/>
                <item value="Coherent anti-Stokes Raman spectroscopy (CARS)"/>
                <item value="other"/>
            </enumeration>
        </field>
        <field name="experiment_type_other" optional="true">
            <doc>
                 If the experiment_type is `other`, a name should be specified here.
            </doc>
        </field>
        <group type="NXinstrument">
            <doc>
                 Metadata of the setup, its optical elements and physical properites which
                 defines the Raman measurement.
            </doc>
            <group name="device_information" type="NXfabrication" recommended="true">
                <doc>
                     Name of the company which build the instrument.
                </doc>
                <field name="vendor" recommended="true"/>
                <field name="model" recommended="true"/>
                <field name="identifier" recommended="true"/>
                <field name="construction_year" type="NX_DATE_TIME" optional="true">
                    <doc>
                         ISO8601 date when the instrument was constructed.
                         UTC offset should be specified.
                    </doc>
                </field>
            </group>
            <group name="software" type="NXprocess">
                <field name="program">
                    <doc>
                         Commercial or otherwise defined given name of the program that was
                         used to generate the result file(s) with measured data and metadata.
                         This program converts the measured signals to Raman data. If
                         home written, one can provide the actual steps in the NOTE subfield
                         here.
                    </doc>
                </field>
            </group>
            <field name="incident_source_wavelength" type="NX_NUMBER" units="NX_LENGTH">
                <doc>
                     Which indicent wavelength was used for e.g. a laser source.
                     For multiple excitation wavelengths, please state the specific discret
                     wavelengths (i.e. for dye laser) or the specific contnious range
                     (i.e for white light laser source)
                </doc>
            </field>
            <field name="scattering_configuration" type="NX_CHAR">
                <!--
unit: NX_LENGTH
-->
                <doc>
                     Scattering configuration as defined by the porto notation by three
                     states, which are othogonal to each other. Example: z(xx)z for
                     parallel polarized backscattering configuration.
                     
                     See:
                     https://www.cryst.ehu.es/cgi-bin/cryst/programs/nph-doc-raman
                     
                     A(BC)D
                     
                     A = The propagation direction of the incident light (k_i)
                     B = The polarization direction of the incident light (E_i)
                     C = The polarization direction of the scattered light (E_s)
                     D = The propagation direction of the scattered light (k_s)
                     
                     An orthogonal base is assumed.
                     Linear polarized light is displayed by e.g. "x","y" or "z"
                     Unpolarized light is displayed by "."
                </doc>
                <attribute name="non_orthogonal_base_vectors" type="NX_NUMBER">
                    <!--
unit: NX_LENGTH
-->
                    <doc>
                         Scattering configuration as defined by the porto notation given by
                         respective vectors.
                         
                         Vectors in the porto notation are defined as for A, B, C, D above.
                         Linear light polarization is assumed.
                    </doc>
                    <dimensions rank="2">
                        <doc>
                             3 x 4 Matrix, which lists the porto notation vectors A, B, C, D.
                             A has to be perpendicular to B and C perpendicular to D.
                        </doc>
                        <dim index="1" value="4"/>
                        <dim index="2" value="3"/>
                    </dimensions>
                </attribute>
            </field>
            <!--In the following - Auxillary NXbeam_devices are defined, to enable a
beam path description of the setup, while using the up now available
Nexus definitions for source, detector, monochromator, ...-->
            <group name="opt_source" type="NXbeam_device">
                <doc>
                     This is the beam device instance of the optical source.
                     
                     It enables a description of the optical setup via NXbeam_devices to 
                     be able to connect the components. This connection is then a "beam path".
                     
                     The properties of the source are located in a NXsource group.
                     [Note: the idea is to incorporate later NXbeam_device into NXsource]
                     
                     This is done similarily with NXlens_opt, NXdetector, NXwaveplate and NXmonochromator.
                </doc>
                <attribute name="device">
                    <doc>
                         It should contain the name of the Nexus source group.
                    </doc>
                </attribute>
            </group>
            <group name="incident_light_optics" type="NXbeam_device">
                <doc>
                     Beam device instance of the incident light optics.
                </doc>
                <attribute name="device">
                    <doc>
                         It should contain the name of the "incident_light_lens(NXlens_opt)" group
                    </doc>
                </attribute>
            </group>
            <group name="scattered_light_optics" type="NXbeam_device">
                <doc>
                     Beam device instance of the scattered light optics.
                </doc>
                <attribute name="device">
                    <doc>
                         It should contain the name of the "scattered_light_lens(NXlens_opt)" group
                    </doc>
                </attribute>
            </group>
            <group name="opt_detector" type="NXbeam_device">
                <doc>
                     Properties of the detector to link it via NXbeam_device to other beam
                     elements
                </doc>
                <attribute name="device">
                    <doc>
                         It should contain the name of the Nexus detector group
                    </doc>
                </attribute>
            </group>
            <group name="polarization_manipulator_NAME" type="NXbeam_device" optional="true">
                <doc>
                     Link to the device, that it can be used to generate a beam path via
                     NXbeam_device. The string &gt;NAME&lt; in the name of this NXbeam_device
                     has to identical to &gt;NAME&lt; in waveplate_NAME(NXwaveplate).
                </doc>
                <attribute name="device">
                    <doc>
                         This should contain the name for each halfwave plate used in the
                         NXwaveplate group.
                    </doc>
                </attribute>
            </group>
            <group name="opt_monochromator" type="NXbeam_device" optional="true">
                <doc>
                     Dispersive element to create e.g. an energetic resolution used in the 
                     measurement.
                </doc>
                <attribute name="device">
                    <doc>
                         It should contain the name of the Nexus Monochromator group
                    </doc>
                </attribute>
            </group>
            <group name="sample_as_beam_element" type="NXbeam_device">
                <doc>
                     Enables beam path description of the sample in the setup.
                     it in a beam path.
                </doc>
                <attribute name="device">
                    <doc>
                         Contains the link to the sample.
                    </doc>
                </attribute>
            </group>
            <!--End of Auxillary NXbeam_devices-->
            <!--Below:
generic NeXus definition for optical elements of the setup-->
            <group type="NXsource">
                <doc>
                     Light source with arbitrary choice of name. This shall be referenced
                     by source(NXbeam_device)
                </doc>
                <field name="source_type">
                    <enumeration>
                        <item value="laser"/>
                        <item value="dye-laser"/>
                        <item value="broadband tunable light source"/>
                        <item value="other"/>
                    </enumeration>
                </field>
            </group>
            <group type="NXdetector">
                <doc>
                     Detector with arbitrary choice of the name, which shall be referenced
                     by the detector(NXbeam_device).
                </doc>
            </group>
            <group type="NXmonochromator">
                <doc>
                     Monochromator with arbitrary choice of the name, which shall be referenced
                     by the spectrometer(NXbeam_device).
                </doc>
            </group>
            <!--Below:
NeXus definition derived optical elements of the setup-->
            <group name="incident_light_lens" type="NXlens_opt" recommended="true">
                <doc>
                     This is the optical element used for the incident light in the Raman
                     scattering process.
                     
                     This can be for example a simple lens or microscope
                     objective.
                </doc>
                <field name="type">
                    <enumeration>
                        <item value="objective"/>
                        <item value="lens"/>
                        <item value="glass fiber"/>
                        <item value="none"/>
                        <item value="other"/>
                    </enumeration>
                </field>
                <field name="numerical_aperture" type="NX_NUMBER">
                    <doc>
                         The numerical aperture of the used incident light optics.
                    </doc>
                </field>
            </group>
            <group name="scattered_light_lens" type="NXlens_opt" recommended="true">
                <doc>
                     This is the optical element used for the incident light in the Raman
                     scattering process.
                     
                     This can be for example a simple lens or microscope
                     objective.
                </doc>
                <field name="type">
                    <enumeration>
                        <item value="objective"/>
                        <item value="lens"/>
                        <item value="glass fiber"/>
                        <item value="none"/>
                        <item value="other"/>
                    </enumeration>
                </field>
                <field name="numerical_aperture" type="NX_NUMBER">
                    <doc>
                         The numerical aperture of the used incident light optics.
                    </doc>
                </field>
            </group>
            <group name="waveplate_NAME" type="NXwaveplate">
                <doc>
                     Properties of the device for the manipulation of the state of light which is a half wave
                     plate.
                </doc>
                <field name="type">
                    <enumeration>
                        <item value="objective"/>
                        <item value="lens"/>
                        <item value="glass fiber"/>
                        <item value="none"/>
                        <item value="other"/>
                    </enumeration>
                </field>
            </group>
            <!--Below:
NXraman specific optical elements-->
            <group name="polarization_filter" type="NXbeam_device">
                <field name="filter_mechanism" type="NX_CHAR" optional="true">
                    <doc>
                         Physical principle of the polarization filter used to create a
                         defined incident or scattered light state.
                    </doc>
                    <enumeration>
                        <item value="Polarization by Fresnel reflection"/>
                        <item value="Birefringent polarizers"/>
                        <item value="Thin film polarizers"/>
                        <item value="Wire-grid polarizers"/>
                        <item value="other"/>
                    </enumeration>
                </field>
                <field name="specific_polarization_filter_type" type="NX_CHAR">
                    <doc>
                         Specific name or type of the polarizer used.
                         
                         Free text, for example: Glan-Thompson, Glan-Taylor, Rochon Prism, Wollaston
                         Polarizer...
                    </doc>
                </field>
            </group>
            <group name="spectral_filter_N" type="NXbeam_device">
                <field name="filter_type" optional="true">
                    <doc>
                         Type of laserline filter used to supress the laser, if measurements
                         close to the laserline are performed.
                    </doc>
                    <enumeration>
                        <item value="long-pass filter"/>
                        <item value="short-pass filter"/>
                        <item value="Notch filter"/>
                        <item value="reflection filter"/>
                        <item value="neutral density filter"/>
                        <item value="other"/>
                    </enumeration>
                </field>
                <field name="intended_use" optional="true">
                    <doc>
                         Type of laserline filter used to supress the laser, if measurements
                         close to the laserline are performed.
                    </doc>
                    <enumeration>
                        <item value="laser line cleanup"/>
                        <item value="raylight line removal"/>
                        <item value="spectral filtering"/>
                        <item value="intensity manipulation"/>
                        <item value="other"/>
                    </enumeration>
                </field>
                <field name="filter_characteristics" type="NX_NUMBER" optional="true">
                    <doc>
                         Properties of the spectral filter such as wavelength dependent Transmission
                         or reflectivity.
                    </doc>
                    <dimensions rank="2">
                        <dim index="1" value="2"/>
                        <dim index="2" value="N_spectrum_filter"/>
                    </dimensions>
                    <!--2 -> [Wavelength, Transmission]
N_spectrum_filter -\-> Number of wavelengths-->
                    <attribute name="characteristics_type" optional="true">
                        <doc>
                             Which property is used to form the spectral properties of light,
                             i.e. transmission or reflection properties.
                        </doc>
                        <enumeration>
                            <item value="transmission"/>
                            <item value="reflection"/>
                        </enumeration>
                    </attribute>
                </field>
            </group>
        </group>
        <group type="NXsample">
            <field name="name" optional="false"/>
            <field name="sample_id" recommended="true"/>
            <field name="chemical_formula" recommended="true"/>
        </group>
        <group name="data_collection" type="NXprocess">
            <field name="data_type">
                <doc>
                     Select which type of data was recorded, for example a simple spectrum
                     with intensity vs. Raman shift, CCD image or a set of spectra with
                     probe, reference and background signals for pump beam on and off.
                </doc>
                <enumeration>
                    <item value="Integrated single spectrum"/>
                    <item value="CCD image"/>
                    <item value="Probe + Background + Reference for Pump-on and Pump-off (i.e. for FSRS)"/>
                </enumeration>
            </field>
        </group>
    </group>
</definition>

<?xml version='1.0' encoding='UTF-8'?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl"?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2014-2024 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org
-->
<definition xmlns="http://definition.nexusformat.org/nxdl/3.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" category="base" type="group" name="NXatom" extends="NXobject" xsi:schemaLocation="http://definition.nexusformat.org/nxdl/3.1 ../nxdl.xsd">
    <doc>
        Base class for documenting a set of atoms.
        
        Atoms in the set may be bonded.
        The atoms in the set may have a net charge thus representing an ion.
        Such ion can be a molecular ion.
    </doc>
    <field name="name" type="NX_CHAR">
        <doc>
            Human-readable name for the set.
            
            An exemplar use case is for the field of atom probe tomography where
            this field can be used to store a standardized human-readable name of
            the element or (molecular) ion like such as Al +++ or 12C +.
        </doc>
    </field>
    <field name="identifier_chemical" type="NX_CHAR">
        <enumeration>
            <item value="inchi"/>
        </enumeration>
    </field>
    <field name="charge" type="NX_NUMBER" units="NX_CHARGE">
        <doc>
            Signed net (partial) charge of the (molecular) ion.
            
            Neither (molecular) ions or a charged cluster of atoms has a unique charge
            as this property depends on the space over which the charge is computed.
            See `T. A. Manz &lt;10.1039/c6ra04656h&gt;`_ and `N. G. Limas &lt;10.1039/C6RA05507A&gt;`_ for computational details.
        </doc>
    </field>
    <field name="charge_state" type="NX_INT" units="NX_UNITLESS">
        <doc>
             Signed charge state of the ion in multiples of electron charge.
             
             In the example of atom probe microscopy, only positive values will be measured
             as the ions are accelerated by a negatively signed bias electric field.
             In the case that the charge state is not explicitly recoverable, the value should
             be set to zero.
             
             In atom probe microscopy this is for example the case when using
             classical ranging definition files in formats like RNG, RRNG.
             These file formats do not document the charge state explicitly
             but the number of atoms of each element per molecular ion
             surplus the mass-to-charge-state-ratio interval.
             Details on ranging definition files can be found in the literature:
             `M. K. Miller &lt;https://doi.org/10.1002/sia.1719&gt;`_
        </doc>
    </field>
    <field name="volume" type="NX_NUMBER" units="NX_VOLUME">
        <doc>
            Assumed volume affected by the set of atoms.
            
            Neither individual atoms nor a set of cluster of these have a uniquely defined volume
            as this property depends on the space that is defined covered by the set.
        </doc>
    </field>
    <!--define NXapm_ion extending NXatom for the specific use case of atom probe-->
    <!--geometry of the set-->
    <!--
        <group type="NXcg_point"/>
    -->
    <field name="identifier" type="NX_CHAR">
        <doc>
             Identifier for each atom at locations as detailed by position.
        </doc>
        <dimensions rank="1">
            <dim index="1" value="n_pos"/>
        </dimensions>
    </field>
    <field name="type" type="NX_UINT" units="NX_UNITLESS">
        <doc>
            Nuclide information for each atom at locations as detailed by position.
            
            One `approach &lt;https://doi.org/10.1017/S1431927621012241&gt;`_ for storing nuclide information efficiently
            is via hashing with the following formula
            
            :math:`H` is :math:`H = Z + N \cdot 256` with :math:`Z`
            
            the number of protons and :math:`N` the number of neutrons
            of each nuclide given as 8-bit unsigned integer values.
        </doc>
        <dimensions rank="1">
            <dim index="1" value="n_pos"/>
        </dimensions>
    </field>
    <field name="position" type="NX_NUMBER" units="NX_ANY">
        <doc>
             Position of each atom.
        </doc>
        <dimensions rank="2">
            <dim index="1" value="n_pos"/>
            <dim index="2" value="d"/>
        </dimensions>
        <attribute name="reference_frame" type="NX_CHAR">
            <doc>
                 Path to a reference frame in which positions are defined
                 to resolve ambiguity when the reference frame is different
                 to the NeXus default reference frame (McStas).
            </doc>
        </attribute>
    </field>
    <field name="occupancy" type="NX_NUMBER" units="NX_DIMENSIONLESS">
        <doc>
             Relative occupancy of the atom position.
            
            This field is useful for specifying the atomic motif in
            instances of :ref:`NXcrystal_structure`.
        </doc>
        <dimensions rank="1">
            <dim index="1" value="n_pos"/>
        </dimensions>
    </field>
</definition>
